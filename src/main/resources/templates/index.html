<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="https://www.thymeleaf.org/">

<head>
    <link rel="icon" href="images/icon.png" type="image/x-icon"/>
    <meta charset="utf-8">
    <title>Dragon's Twilight 龙之暮</title>
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/loading.css">
    <link rel="stylesheet" href="/live2d/css/live2d.css"/>
    <style type="text/css">
        body {
            background: url('images/bg.jpg') 50% / cover no-repeat;
        }

        .menu-wrap ul li a {
            cursor: pointer;
        }

        .mask {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: rgba(0, 0, 0, .6);
            /*Opacity: 50%;*/
        }

        .liCheck {
            background-color: #285e9d;
        }

        .aCheck {
            color: #fff !important;
        }
    </style>
</head>

<body>
<nav class="menu-wrap" id="menu-nav">
    <div class="menu">
        <ul th:each="webNavIframe:${webNavIframeList}">
            <li th:id="'navLi'+${webNavIframe.id}">
                <a th:id="'navA'+${webNavIframe.id}"
                   th:onclick="changeSrc('?goUrl='+[[${webNavIframe.uri}]]+'&actionId='+[[${webNavIframe.id}]])">
                    <i th:class="'fa fa-lg ' + ${webNavIframe.icon}"></i>
                    <span class="nav-text" th:text="${webNavIframe.title}"></span>
                </a>
            </li>
        </ul>
    </div>
</nav>
<div id="landlord" style="left: 80%">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="280" height="250" class="live2d"></canvas>
    <!--    <div class="hide-button">隐藏</div>-->
</div>
<iframe th:src="${goUrl}" width="100%" height="100%" id="mainFrame"
        style="border: 0;display: none;" onload="stateChangeFirefox(this)">
</iframe>
<div id="LoadDiv" class="mask" style="align:center;width: 100%;height:100%;text-align: center">
    <div id="loadDivInner" class="container animation-1"
         style="text-align: center;align:center;margin-left: 50%;margin-top: 20%">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
        <div class="shape shape4"></div>
    </div>
</div>

<!--隐藏域-->
<p th:text="${actionId}" type="hidden" id="actionId">123</p>
</body>
<script src="webjars/jquery/3.5.1/dist/jquery.min.js"></script>
<script type="text/javascript" th:inline="javascript">

    $(function () {
        let activeId = $("#actionId").text();
        if (activeId === 'none') {
            //初始化样式
            $("#navLi7").addClass("liCheck");
            $("#navA7").addClass('aCheck');
        }else{
            //删除旧样式
            $(".liCheck", parent.document).removeClass('liCheck');
            $(".aCheck", parent.document).removeClass('aCheck');
            //添加选中样式
            $("#navLi" + activeId, parent.document).addClass('liCheck');
            $("#navA" + activeId, parent.document).addClass('aCheck');
        }
    });

    function changeSrc(url) {
        if (url === "#") {
            return;
        }
        $('#landlord').css('display', 'none');
        const iframe = document.getElementById("mainFrame");
        iframe.src = url;
    }

    function stateChangeFirefox(_frame) {
        const loader = document.getElementById("LoadDiv");
        loader.style.display = "none";
        _frame.style.visibility = "visible";
        _frame.style.display = "block";
    }
</script>
<script type="text/javascript">
    const message_Path = '/live2d/';
    const home_Path = 'https://mc.goblincwl.cn/';
</script>
<script type="text/javascript" src="/live2d/js/live2d.js"></script>
<script type="text/javascript" src="/live2d/js/message.js"></script>
<script type="text/javascript">
    loadlive2d("live2d", "/live2d/model/tia/13.json");
</script>
</html>